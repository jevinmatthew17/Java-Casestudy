package casestudy;
import java.sql.*;
import java.util.Scanner;

public class name {
	public static void sname()
	{
		String jdbcURL = "jdbc:mysql://localhost:3306/case_study";
        String username = "root";
        String password = "Mountain@2000";

			Connection con = null;

			int flag=0;
			try {
				
				 con = DriverManager.getConnection(jdbcURL, username, password);
	             con.setAutoCommit(false);
				
				Class.forName("com.mysql.cj.jdbc.Driver");
			
					Statement st = con.createStatement();
					
					Scanner sc= new Scanner(System.in);
					
					System.out.println("Enter First Name");
					String first=sc.next();
					String fname = "'"+first+"'";
					
					System.out.println("Enter Last Name");
					String last=sc.next();
					String lname = "'"+last+"'";
					
					String data = String.format("SELECT * FROM person join contact_info on person.person_id = contact_info.person_id where first_name = %s and last_name = %s;",fname,lname);
					PreparedStatement ps = con.prepareStatement(data);
					ResultSet res = st.executeQuery(data.toString());

				
				
					
					 while (res.next()) {
						 	String person_id = res.getString("Person_id");
							String first_name = res.getString("first_name");
							String last_name = res.getString("last_name");
							String gender = res.getString("gender");
							String ssn = res.getString("ssn");
							String email = res.getString("email");
							String address = res.getString("address");
							String phone_no = res.getString("phone_no");
							//String car_make = res.getString("car_make");
							//String car_model = res.getString("car_model");
							//String car_model_year = res.getString("car_model_year");
							//String car_VIN = res.getString("car_VIN");
							

						// Beautification of output
						System.out.format("%5s %10s %10s %10s %10s %20s  %10s %10s\n",person_id,first_name,last_name,gender,ssn,email,address,phone_no);	 
					 }
					 
					 String sql1=String.format("SELECT * FROM person JOIN vehicle_info ON person.person_id = vehicle_info.person_id  Where first_name= %s AND last_name= %s ;",fname,lname);
				     PreparedStatement ps1= con.prepareStatement(sql1);
				     ResultSet rs1= st.executeQuery(sql1.toString());
				     while(rs1.next()==true) {
				    	    String car_make= rs1.getString("car_make");
					        String car_model= rs1.getString("car_model");
					        String car_model_year= rs1.getString("car_model_year");
					        String car_vin= rs1.getString("car_vin");
					       
					       
					       System.out.format("%10s %10s %10s %10s\n",car_make,car_model,car_model_year,car_vin);
					      
					       
					       flag=1;
				     }
					 
					
						if(flag==0)
						{
							System.out.println("not founded");
						}
					con.close();
				}

				
				catch (Exception s) {
					System.out.println("enter");
					
					s.printStackTrace();
				}

				
			}
			
		
	}

